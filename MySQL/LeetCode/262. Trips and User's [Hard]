SELECT
    T.REQUEST_AT AS Day,
    ROUND(SUM(CASE WHEN STATUS LIKE 'cancelled%' THEN 1 ELSE 0 END) / COUNT(*), 2) AS "Cancellation Rate"
FROM
    TRIPS T 
    JOIN USERS C ON (T.CLIENT_ID = C.USERS_ID)
    JOIN USERS D ON (T.CLIENT_ID = D.USERS_ID)
WHERE
    C.BANNED = 'No' AND
    D.BANNED = 'No' AND
    T.REQUEST_AT BETWEEN '2013-10-01' AND '2013-10-03'
GROUP BY
    T.REQUEST_AT
